<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Big Oles Financial - Get Your Free Quote</title>
  <style>
    body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f9f9f9; }
    header { background: url('https://neyssalee.com/wp-content/uploads/2023/06/Seattle_snoqualmie_family_photographer_neyssa_lee__3289-scaled.jpg') center/cover no-repeat; color:white; text-align:center; padding:80px 20px; }
    header h1 { font-size:2.5em; margin:0; text-shadow:2px 2px 4px rgba(0,0,0,0.7); }
    header p { font-size:1.2em; text-shadow:1px 1px 3px rgba(0,0,0,0.6); }
    main { max-width:600px; margin:30px auto; background:white; padding:30px; border-radius:10px; box-shadow:0 4px 10px rgba(0,0,0,0.1); }
    form label { display:block; margin-top:15px; font-weight:bold; }
    form input, form select { width:100%; padding:10px; margin-top:5px; border-radius:5px; border:1px solid #ccc; }
    form button { margin-top:20px; width:100%; padding:12px; border:none; background:#007BFF; color:white; font-size:16px; font-weight:bold; border-radius:5px; cursor:pointer; }
    form button:hover { background:#0056b3; }
    form button:disabled { background:#aaa; cursor:not-allowed; }
    footer { text-align:center; margin:30px 0; font-size:0.9em; color:#777; }

    .tooltip {
      display:none;
      font-size:0.9em;
      color:#555;
      margin-top:5px;
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.7; transform: scale(1.02); }
      100% { opacity: 1; transform: scale(1); }
    }

    .modal {
      display: none; 
      position: fixed; 
      z-index: 1000; 
      left: 0; top: 0; 
      width: 100%; height: 100%; 
      background: rgba(0,0,0,0.5); 
      justify-content: center; 
      align-items: center;
    }
    .modal-content {
      background: #fff;
      padding: 30px;
      border-radius: 10px;
      text-align: center;
      max-width: 400px;
      width: 90%;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
      animation: fadeIn 0.3s ease-in-out;
    }
    .modal-content h2 { color: #28a745; margin-bottom: 15px; }
    .modal-content p { color: #333; margin-bottom: 20px; }
    .modal-content button {
      background: #007BFF;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
    }
    .modal-content button:hover { background: #0056b3; }
    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1); }
    }
  </style>
</head>
<body>
  <header>
    <h1>Protect What Matters Most</h1>
    <p>Affordable Life Insurance Plans for Families</p>
  </header>

  <main>
    <h2>Get Your Free Quote</h2>
    <form id="quoteForm">
      <label for="name">Full Name</label>
      <input type="text" id="name" name="name" required>

      <label for="age">Age</label>
      <input type="number" id="age" name="age" min="18" max="120" required>

      <label for="email">Email</label>
      <input type="email" id="email" name="email" required>

      <label for="phone">Phone Number</label>
      <input type="tel" id="phone" name="phone" maxlength="14" placeholder="(123) 456-7890" required>

      <label for="state">State</label>
      <select id="state" name="state" required>
        <option value="">-- Select Your State --</option>
        <option value="AL">Alabama</option>
        <option value="AK">Alaska</option>
        <option value="AZ">Arizona</option>
        <option value="AR">Arkansas</option>
        <option value="CA">California</option>
        <option value="CO">Colorado</option>
        <option value="CT">Connecticut</option>
        <option value="DE">Delaware</option>
        <option value="FL">Florida</option>
        <option value="GA">Georgia</option>
        <option value="HI">Hawaii</option>
        <option value="ID">Idaho</option>
        <option value="IL">Illinois</option>
        <option value="IN">Indiana</option>
        <option value="IA">Iowa</option>
        <option value="KS">Kansas</option>
        <option value="KY">Kentucky</option>
        <option value="LA">Louisiana</option>
        <option value="ME">Maine</option>
        <option value="MD">Maryland</option>
        <option value="MA">Massachusetts</option>
        <option value="MI">Michigan</option>
        <option value="MN">Minnesota</option>
        <option value="MS">Mississippi</option>
        <option value="MO">Missouri</option>
        <option value="MT">Montana</option>
        <option value="NE">Nebraska</option>
        <option value="NV">Nevada</option>
        <option value="NH">New Hampshire</option>
        <option value="NJ">New Jersey</option>
        <option value="NM">New Mexico</option>
        <option value="NY">New York</option>
        <option value="NC">North Carolina</option>
        <option value="ND">North Dakota</option>
        <option value="OH">Ohio</option>
        <option value="OK">Oklahoma</option>
        <option value="OR">Oregon</option>
        <option value="PA">Pennsylvania</option>
        <option value="RI">Rhode Island</option>
        <option value="SC">South Carolina</option>
        <option value="SD">South Dakota</option>
        <option value="TN">Tennessee</option>
        <option value="TX">Texas</option>
        <option value="UT">Utah</option>
        <option value="VT">Vermont</option>
        <option value="VA">Virginia</option>
        <option value="WA">Washington</option>
        <option value="WV">West Virginia</option>
        <option value="WI">Wisconsin</option>
        <option value="WY">Wyoming</option>
      </select>

      <div id="recaptcha-container"></div>

      <label for="verificationCode">Verification Code</label>
      <input type="text" id="verificationCode" placeholder="Enter code after SMS">
      <div class="tooltip" id="smsTooltip">ðŸ’¡ Check your spam folder or wait a few minutes for the SMS.</div>

      <button type="button" id="sendCodeBtn">Send Code</button>
      <button type="button" id="verifyBtn">Verify & Submit</button>
    </form>
  </main>

  <footer>
    <p>&copy; 2025 Big Oles Financial</p>
  </footer>

  <div class="modal" id="successModal">
    <div class="modal-content">
      <h2>âœ… Success!</h2>
      <p>Your information has been submitted. An agent will contact you within 24 hours.</p>
      <button id="closeModal">OK</button>
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyD5MUrEfk3LoOsIUcACzqjItyuyvkdXT7g",
      authDomain: "big-oles-financial.firebaseapp.com",
      projectId: "big-oles-financial",
      storageBucket: "big-oles-financial.firebasestorage.app",
      messagingSenderId: "360749179189",
      appId: "1:360749179189:web:7dbf3605774b7bb7aaec7c"
    };
    firebase.initializeApp(firebaseConfig);

    let recaptchaVerifier;
    let confirmationResult;

    function setupRecaptcha() {
      if (!recaptchaVerifier) {
        recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container', { size: 'invisible' });
        recaptchaVerifier.render();
      }
    }

    const phoneInput = document.getElementById('phone');
    phoneInput.addEventListener('input', (e) => {
      let x = e.target.value.replace(/\D/g,'').substring(0,10);
      let formatted = '';
      if(x.length > 0) formatted = '(' + x.substring(0,3);
      if(x.length >= 4) formatted += ') ' + x.substring(3,6);
      if(x.length >= 7) formatted += '-' + x.substring(6,10);
      e.target.value = formatted;
    });

    const sendBtn = document.getElementById("sendCodeBtn");
    const codeInput = document.getElementById("verificationCode");
    const tooltip = document.getElementById("smsTooltip");

    function startCooldown(seconds) {
      sendBtn.disabled = true;
      let remaining = seconds;
      sendBtn.textContent = `Resend Code (${remaining}s)`;
      const interval = setInterval(() => {
        remaining--;
        sendBtn.textContent = `Resend Code (${remaining}s)`;
        if (remaining <= 0) {
          clearInterval(interval);
          sendBtn.disabled = false;
          sendBtn.textContent = "Send Code";
        }
      }, 1000);
    }

    sendBtn.addEventListener("click", () => {
      setupRecaptcha();
      
      // Show tooltip each time Send Code is clicked
      tooltip.style.display = 'block';
      setTimeout(() => { tooltip.style.display = 'none'; }, 15000); // Hide after 15 seconds

      const rawPhone = phoneInput.value.replace(/\D/g,'');
      if (rawPhone.length !== 10) { alert("Please enter a valid 10-digit phone number."); return; }

      firebase.auth().signInWithPhoneNumber("+1" + rawPhone, recaptchaVerifier)
        .then(result => { 
          confirmationResult = result; 
          alert("âœ… Code sent to your phone."); 
          codeInput.focus();
          startCooldown(60); 
        })
        .catch(error => { 
          console.error("Error sending code:", error); 
          alert("Error sending code: " + error.message); 
        });
    });

    document.getElementById("verifyBtn").addEventListener("click", () => {
      const code = codeInput.value;
      if (!confirmationResult) { alert("Please request a code first."); return; }

      confirmationResult.confirm(code)
        .then(() => {
          const payload = {
            name: document.getElementById("name").value,
            age: document.getElementById("age").value,
            email: document.getElementById("email").value,
            phone: phoneInput.value.replace(/\D/g,''), 
            state: document.getElementById("state").value
          };

fetch("https://script.google.com/macros/s/AKfycbylRcyBk_Sz5sWCaBtxZXLTb03-N-zdRDNTmQyk6SCtHmX5VRV7X05697vm09bhCBSWNg/exec", {
        method: "POST",
        mode: "no-cors",   // ðŸ‘ˆ important fix
        body: JSON.stringify(payload)
      })
      .then(() => {
        // Show success modal â€” can't read server JSON due to no-cors
        document.getElementById("successModal").style.display = "flex";
        document.getElementById("quoteForm").reset();
        tooltip.style.display = 'none';
      })
      .catch(error => {
        console.error("Error submitting data:", error);
        alert("Error submitting data. Please try again.");
      });

    })
    .catch(error => {
      console.error("Error verifying code:", error);
      alert("Invalid verification code. Please try again.");
    });
});

    document.getElementById("closeModal").addEventListener("click", () => {
      document.getElementById("successModal").style.display = "none";
    });
  </script>
</body>
</html>
